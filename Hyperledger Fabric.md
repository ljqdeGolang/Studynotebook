# Hyperledger Fabric

## 一、前言

### 1、背景

随着比特币、以太坊和其他一些衍生技术的普及，越来越多的人想要将**区块链基础技术、分布式账本和分布式应用平台**用到*企业*业务中。

对于企业应用，我们需要考虑以下要求：

1、参与者必须是已认证的或者可识别的
2、网络需要获得许可
3、高交易吞吐量性能
4、交易确认低延迟
5、与商业交易有关的交易和数据的隐私和机密性

### 2、Hyperledger Fabric 基础介绍

Linux 基金会于2015年创建了 Hyperledger（超级账本）项目，以推进跨行业的区块链技术。它不是用来宣布一个区块链标准，而是鼓励通过社区流程开发区块链技术的协作方法，其中包括鼓励开放式开发、和随着时间的推移采用关键标准的知识产权。

Hyperledger Fabric 是一个开源的企业级许可分布式账本技术（Distributed Ledger Technology，DLT）平台，专为在企业环境中使用而设计。差异化设计特性的结合使 Fabric 成为当今交易处理和交易确认延迟方面**性能较好的平台**之一，并且它实现了交易的**隐私和保密**以及智能合约（Fabric 称之为“链码”）。

它具有以下特征：1）高度模块化和可配置架构、2）支持通用编程语言编写智能合约、3）许可网络，参与者并不是完全不信任的、4）支持可插拔共识协议、5）可以利用不需要原生加密货币的共识协议来激励昂贵的挖矿或推动智能合约执行。

### 3、关键概念

3.1 智能合约

区块链使用 **智能合约** 来提供对账本的受控访问。智能合约不仅是在网络中封装和简化信息的关键机制，它还可以被编写成自动执行参与者的特定交易的合约。

区块链好处（超级账本方认为）

即使可见性和信任的需求很明确，但在如今信息和流程共享的方法支离破碎，不可能构建一个跨业务网络的记录系统。利用共享账本协调其业务网络的能力，区块链网络可以减少与处理私人信息相关的时间、成本和风险，同时提高信任和可见性。

3.2 Hyperledger Fabric模型

Hyperledger Fabric 网络的成员需要从可信赖的 **成员服务提供者（MSP）** 注册。

资产：可以涵盖有形（房地产和硬件）和无形资产（合同和知识产权）。资产在 Hyperledger Fabric 中被表示为键值对的集合，状态更改记录为 Channel 账本上的交易。资产可以用二进制或 JSON 表示。

链码：链码是定义单项或多项资产，和能修改资产的交易指令的软件；换句话说，它是业务逻辑。

状态转换是参与者提交链码调用（“交易”）的结果。

账本由区块链（“链”）组成，用于存储区块中不可更改并有序的的记录，以及维护当前 Fabirc 状态的状态数据库。每个通道有一个账本。每个节点为其所属的每个通道维护一个账本的副本。

隐私：通道保持广泛的网络上的交易的私密性，而集合则保持通道上的组织子集之间数据的私密性。

3.3 区块链网络

 Hyperledger Fabric 是如何让组织间以区块链网络的形式进行合作。

区块链网络是一个为应用程序提供账本及智能合约（chaincode）服务的技术基础设施。

创建网络：通道配置CC1已由组织R1、R2和R0同意，并包含在称为“配置块”的块中，该块通常由`configtxgen`工具根据`configtx.yaml`文件创建。此配置块包含可以连接组件并在通道上交互的组织的记录，以及定义如何做出决策和达到特定结果的结构的**策略**。

节点加入通道：节点是网络的基本元素，因为它们拥有账本和链码(包含智能合约)，而且是在通道上进行交易的组织连接到另一个通道(另一个是应用程序)的物理节点之一。

安装、批准和提交链码：包含智能合约的结构称为链码(chaincode)，安装在相关的peer节点上，由相关节点的组织批准，并在通道上提交。通过这种方式，您可以考虑将链码**物理托管**在peer节点上，但**逻辑托管**在通道上。

在通道上使用应用程序：提交智能合约后，客户端应用程序可以通过Fabric Gateway服务(网关)调用链码上的事务。

加入多个通道：首先需要创建新的通道配置，其次，将组件加入到新通道。

将组织添加到现有的通道中：决定新组织的权限和角色。更新通道，包括相关的链码，以反映这些决策。组织将其peer节点(以及潜在的排序节点)加入通道，并开始参与交易。